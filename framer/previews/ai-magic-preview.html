<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>CODED Program Finder — Component Preview</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600&family=Syne:wght@600;700;800&display=swap" rel="stylesheet" />
<style>
/* ── Reset ─────────────────────────────────────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { font-family: 'DM Sans', sans-serif; background: #F3F6FA; color: #0A1628; }
body { min-height: 100vh; }

/* ── Mesh Background ──────────────────────────────────────────── */
.mesh-bg {
    position: relative;
    width: 100%;
    padding: 80px 24px 100px;
    overflow: hidden;
    background: #F3F6FA;
}
.mesh-blob {
    position: absolute;
    border-radius: 50%;
    pointer-events: none;
    filter: blur(80px);
    will-change: transform;
}
.mesh-blob-1 {
    width: 700px; height: 700px;
    top: 50%; left: 30%;
    background: radial-gradient(circle, rgba(11,29,58,0.18) 0%, transparent 70%);
    animation: drift1 20s ease-in-out infinite;
}
.mesh-blob-2 {
    width: 500px; height: 500px;
    top: 40%; left: 65%;
    background: radial-gradient(circle, rgba(37,99,235,0.105) 0%, transparent 70%);
    animation: drift2 25s ease-in-out infinite;
}
.mesh-blob-3 {
    width: 400px; height: 350px;
    top: 10%; left: 50%;
    background: radial-gradient(circle, rgba(11,29,58,0.075) 0%, transparent 70%);
    animation: drift3 18s ease-in-out infinite;
}
.mesh-blob-4 {
    width: 350px; height: 350px;
    top: 85%; left: 40%;
    background: radial-gradient(circle, rgba(37,99,235,0.06) 0%, transparent 70%);
    animation: drift4 22s ease-in-out infinite;
}

@keyframes drift1 {
    0%   { transform: translate(-50%,-50%) translate(0px,0px) scale(1); }
    25%  { transform: translate(-50%,-50%) translate(15px,-10px) scale(1.03); }
    50%  { transform: translate(-50%,-50%) translate(-8px,12px) scale(0.97); }
    75%  { transform: translate(-50%,-50%) translate(-18px,-6px) scale(1.02); }
    100% { transform: translate(-50%,-50%) translate(0px,0px) scale(1); }
}
@keyframes drift2 {
    0%   { transform: translate(-50%,-50%) translate(0px,0px) scale(1); }
    30%  { transform: translate(-50%,-50%) translate(-12px,18px) scale(1.04); }
    60%  { transform: translate(-50%,-50%) translate(20px,-8px) scale(0.96); }
    100% { transform: translate(-50%,-50%) translate(0px,0px) scale(1); }
}
@keyframes drift3 {
    0%   { transform: translate(-50%,-50%) translate(0px,0px) scale(1); }
    35%  { transform: translate(-50%,-50%) translate(8px,20px) scale(1.05); }
    70%  { transform: translate(-50%,-50%) translate(-14px,-12px) scale(0.95); }
    100% { transform: translate(-50%,-50%) translate(0px,0px) scale(1); }
}
@keyframes drift4 {
    0%   { transform: translate(-50%,-50%) translate(0px,0px) scale(1); }
    40%  { transform: translate(-50%,-50%) translate(-16px,-14px) scale(1.03); }
    80%  { transform: translate(-50%,-50%) translate(10px,16px) scale(0.97); }
    100% { transform: translate(-50%,-50%) translate(0px,0px) scale(1); }
}

/* ── Wizard Card ──────────────────────────────────────────────── */
.finder-card {
    position: relative;
    max-width: 660px;
    width: 100%;
    margin: 0 auto;
    background: rgba(255,255,255,0.65);
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
    border-radius: 20px;
    padding: 48px 52px;
    border: 1px solid rgba(11,29,58,0.06);
    box-shadow: 0 24px 64px rgba(11,29,58,0.08), 0 0 0 1px rgba(255,255,255,0.6) inset;
    overflow: hidden;
    z-index: 1;
}

/* ── Spark decorations ────────────────────────────────────────── */
.spark-field { position: absolute; inset: 0; pointer-events: none; overflow: hidden; z-index: 0; }
.spark-svg { position: absolute; }
@keyframes sparkFloat {
    0%   { transform: translateY(0) rotate(0deg) scale(1); }
    30%  { transform: translateY(-10px) rotate(15deg) scale(1.18); }
    60%  { transform: translateY(-5px) rotate(-8deg) scale(0.88); }
    100% { transform: translateY(0) rotate(0deg) scale(1); }
}

/* ── Typography ───────────────────────────────────────────────── */
.q-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 18px; color: #0A1628; margin-bottom: 6px; line-height: 1.3; }
.q-hint  { font-size: 13px; color: #9AAABB; margin-bottom: 18px; }

/* ── Progress ─────────────────────────────────────────────────── */
.progress-bar { flex: 1; height: 3px; background: #E8EDF3; border-radius: 99px; overflow: hidden; }
.progress-fill { height: 100%; background: #2563EB; border-radius: 99px; transition: width 0.45s cubic-bezier(.65,0,.35,1); }

/* ── Chips ────────────────────────────────────────────────────── */
.chip {
    padding: 9px 18px; border-radius: 100px; font-size: 14px;
    font-family: 'DM Sans', sans-serif; font-weight: 500;
    cursor: pointer; outline: none; white-space: nowrap; user-select: none;
    border: 1.5px solid #DDE3EC; background: #F8FAFB; color: #3A4D63;
    transition: all 0.16s ease;
}
.chip:hover { border-color: #2563EB; background: rgba(37,99,235,0.05); color: #2563EB; }
.chip.selected { border-color: #2563EB; background: #2563EB; color: #fff; }

/* ── Field cards ──────────────────────────────────────────────── */
.field-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.field-card {
    padding: 14px 18px; border-radius: 14px; text-align: left;
    display: flex; align-items: center; gap: 10px; user-select: none;
    font-family: 'DM Sans', sans-serif; font-weight: 500; font-size: 14px;
    cursor: pointer; outline: none;
    border: 1.5px solid #DDE3EC; background: #F8FAFB; color: #3A4D63;
    transition: all 0.16s ease;
}
.field-card:hover { border-color: #2563EB; background: rgba(37,99,235,0.05); color: #2563EB; }
.field-card.selected { border-color: #2563EB; background: #2563EB; color: #fff; }
.field-card .icon-box {
    width: 32px; height: 32px; border-radius: 8px;
    background: rgba(37,99,235,0.08);
    display: flex; align-items: center; justify-content: center;
    font-size: 16px; flex-shrink: 0;
}
.field-card.selected .icon-box { background: rgba(255,255,255,0.2); }
.field-card .label { font-weight: 600; font-size: 14px; }
.field-card .sub { font-size: 12px; opacity: 0.65; margin-top: 1px; }

/* ── Buttons ──────────────────────────────────────────────────── */
.btn-primary {
    background: #0A1628; color: white; border: none; border-radius: 100px;
    padding: 11px 26px; font-family: 'DM Sans', sans-serif; font-weight: 600;
    font-size: 14px; cursor: pointer; outline: none; transition: background 0.18s, transform 0.12s;
}
.btn-primary:hover { background: #2563EB; transform: translateY(-1px); }
.btn-primary:disabled { background: #DDE3EC; color: #A0AEBD; cursor: default; transform: none; }
.btn-ghost {
    background: transparent; border: none; color: #A0AEBD; font-size: 13px;
    font-family: 'DM Sans', sans-serif; cursor: pointer; padding: 11px 6px;
    transition: color 0.15s; outline: none;
}
.btn-ghost:hover { color: #3A4D63; }
.btn-back {
    width: 38px; height: 38px; border-radius: 100px; border: 1.5px solid #DDE3EC;
    background: white; color: #7A8899; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: all 0.16s; flex-shrink: 0; outline: none;
}
.btn-back:hover { border-color: #2563EB; color: #2563EB; }
.btn-outline {
    background: transparent; border: 1.5px solid #DDE3EC; color: #7A8899;
    border-radius: 100px; padding: 10px 20px; font-family: 'DM Sans', sans-serif;
    font-size: 14px; cursor: pointer; outline: none; transition: all 0.15s;
}
.btn-outline:hover { border-color: #2563EB; color: #2563EB; }

/* ── Input ────────────────────────────────────────────────────── */
.text-input {
    width: 100%; background: #F8FAFB; border: 1.5px solid #DDE3EC;
    border-radius: 12px; color: #0A1628; font-size: 15px;
    font-family: 'DM Sans', sans-serif; padding: 13px 16px; outline: none;
    transition: border-color 0.15s, box-shadow 0.15s;
}
.text-input:focus { border-color: #2563EB; box-shadow: 0 0 0 3px rgba(37,99,235,0.1); }

/* ── Nav row ──────────────────────────────────────────────────── */
.nav-row { display: flex; align-items: center; gap: 10px; margin-top: 24px; }
.chips-row { display: flex; flex-wrap: wrap; gap: 9px; }

/* ── Thinking dots ────────────────────────────────────────────── */
.thinking-dots { display: flex; gap: 5px; align-items: center; padding: 18px 0 10px; }
.thinking-dot {
    width: 7px; height: 7px; border-radius: 50%; background: #2563EB;
    animation: thinkBounce 1.1s ease-in-out infinite;
}
.thinking-dot:nth-child(2) { animation-delay: 0.15s; }
.thinking-dot:nth-child(3) { animation-delay: 0.3s; }
@keyframes thinkBounce {
    0%, 80%, 100% { transform: translateY(0); opacity: 0.25; }
    40% { transform: translateY(-6px); opacity: 1; }
}

/* ── Step animation ───────────────────────────────────────────── */
.step-content { animation: stepIn 0.32s ease forwards; }
@keyframes stepIn {
    from { opacity: 0; transform: translateX(18px); }
    to   { opacity: 1; transform: translateX(0); }
}
.step-content.back {
    animation: stepInBack 0.32s ease forwards;
}
@keyframes stepInBack {
    from { opacity: 0; transform: translateX(-18px); }
    to   { opacity: 1; transform: translateX(0); }
}
@keyframes fadeUp {
    from { opacity: 0; transform: translateY(10px); }
    to   { opacity: 1; transform: translateY(0); }
}

/* ── Result Card ──────────────────────────────────────────────── */
.result-card {
    border: 1.5px solid #E4EAF3; border-radius: 16px; padding: 20px;
    background: white; position: relative; overflow: hidden;
    transition: border-color 0.18s, box-shadow 0.18s, opacity 0.4s, transform 0.4s;
    opacity: 0; transform: translateY(12px);
}
.result-card.visible { opacity: 1; transform: translateY(0); }
.result-card:hover { border-color: #2563EB; box-shadow: 0 4px 20px rgba(37,99,235,0.1); }
.result-card.best { border-color: #2563EB; background: linear-gradient(145deg, #F0F6FF, #FAFCFF); }
.result-card .top-line { position: absolute; top: 0; left: 0; right: 0; height: 3px; background: #2563EB; border-radius: 16px 16px 0 0; }
.result-card .badge {
    display: inline-flex; align-items: center; gap: 4px;
    background: rgba(37,99,235,0.08); color: #2563EB;
    border-radius: 100px; padding: 3px 10px; font-size: 11px; font-weight: 600; margin-bottom: 10px;
}
.result-card .card-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 15px; color: #0A1628; margin-bottom: 5px; line-height: 1.3; }
.result-card .card-desc { font-size: 12.5px; color: #7A8899; line-height: 1.55; margin-bottom: 12px; }
.result-card .tags { display: flex; flex-wrap: wrap; gap: 5px; }
.result-card .tag {
    background: #F0F4F8; color: #7A8899;
    border-radius: 100px; padding: 3px 10px; font-size: 11px;
}
.result-card.best .tag { background: rgba(37,99,235,0.08); color: #2563EB; }

/* ── Results grid ─────────────────────────────────────────────── */
.results-grid { display: grid; gap: 12px; }
.results-grid.two-col { grid-template-columns: 1fr 1fr; }

/* ── Course card standalone section ───────────────────────────── */
.standalone-section {
    max-width: 660px; margin: 60px auto; padding: 0 24px;
}
.section-label {
    font-family: 'Syne', sans-serif; font-weight: 700; font-size: 20px;
    color: #0A1628; margin-bottom: 4px;
}
.section-hint { font-size: 13px; color: #9AAABB; margin-bottom: 20px; }
.standalone-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
.standalone-card {
    border: 1.5px solid #E4EAF3; border-radius: 16px; padding: 20px;
    background: white; position: relative; overflow: hidden;
    transition: border-color 0.18s, box-shadow 0.18s;
    animation: fadeUp 0.4s ease forwards;
}
.standalone-card:hover { border-color: #2563EB; box-shadow: 0 4px 20px rgba(37,99,235,0.1); }
.standalone-card.featured { border-color: #2563EB; background: linear-gradient(145deg, #F0F6FF, #FAFCFF); }
.standalone-card .top-line { position: absolute; top: 0; left: 0; right: 0; height: 3px; background: #2563EB; border-radius: 16px 16px 0 0; }
.standalone-card .badge {
    display: inline-flex; align-items: center; gap: 4px;
    background: rgba(37,99,235,0.08); color: #2563EB;
    border-radius: 100px; padding: 3px 10px; font-size: 11px; font-weight: 600; margin-bottom: 10px;
}
.standalone-card .card-title { font-family: 'Syne', sans-serif; font-weight: 700; font-size: 15px; color: #0A1628; margin-bottom: 5px; line-height: 1.3; }
.standalone-card .card-desc { font-size: 12.5px; color: #7A8899; line-height: 1.55; margin-bottom: 12px; }
.standalone-card .tags { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 14px; }
.standalone-card .tag { border-radius: 100px; padding: 3px 10px; font-size: 11px; }
.standalone-card.featured .tag { background: rgba(37,99,235,0.08); color: #2563EB; }
.standalone-card:not(.featured) .tag { background: #F0F4F8; color: #7A8899; }
.standalone-card .cta-btn {
    display: inline-block; background: #2563EB; color: white; border-radius: 100px;
    padding: 9px 20px; font-family: 'DM Sans', sans-serif; font-weight: 600;
    font-size: 13px; text-decoration: none; transition: opacity 0.2s, transform 0.15s;
}
.standalone-card .cta-btn:hover { opacity: 0.85; transform: translateY(-1px); }

/* ── Footer ───────────────────────────────────────────────────── */
.preview-footer { text-align: center; padding: 40px 24px 60px; color: #A0AEBD; font-size: 12px; }
</style>
</head>
<body>

<script>
// ═══════════════════════════════════════════════════════════════════
// CONFIGURATION — Change these to test with live API
// ═══════════════════════════════════════════════════════════════════
const WORKER_URL = ""; // e.g. "https://coded-landingpage.tools-c81.workers.dev"
const ACCENT     = "#2563EB";
const AI_PROMPT  = "You are a training program advisor for CODED, a tech education company in Kuwait.";

// ── Questions config ────────────────────────────────────────────
const QUESTIONS = [
    { id: "employees", text: "How many people will be enrolling?", hint: "We'll use this to match group size and format." },
    { id: "field",     text: "Which field is this training in?", hint: "You can select more than one." },
    { id: "duration",  text: "How long can your team commit to training?", hint: "Shorter doesn't mean less impact \u2014 we design for both." },
    { id: "audience",  text: "Who's this training for?", hint: "Select all that apply." },
    { id: "location",  text: "Where should the training take place?", hint: "We can accommodate any preference." },
    { id: "company",   text: "Who should we address this to?", hint: "A company name or your first name works \u2014 entirely up to you." },
];

// ── Mock courses for local fallback ─────────────────────────────
const COURSES = [
    { id: "AI-BOOT", name: "AI App Developer Bootcamp", duration: "> 5 weeks", audience: ["Technical Teams","Fresh Graduates"], fields: ["AI"], size: "12 \u2013 15", desc: "Hands-on vibe-coding program \u2014 build real AI-powered products from day one." },
    { id: "AI-CHAMP", name: "AI Champions Program", duration: "1 day", audience: ["Executives","Mixed Levels"], fields: ["AI"], size: "< 8", desc: "Strategic AI literacy for leadership \u2014 think differently about automation & tools." },
    { id: "FULLSTACK", name: "Full-Stack Bootcamp", duration: "> 5 weeks", audience: ["Fresh Graduates","Technical Teams"], fields: ["Full-Stack"], size: "12 \u2013 15", desc: "End-to-end web development mastery \u2014 from design to deployment." },
    { id: "DATA", name: "Data Analytics Sprint", duration: "< 3 weeks", audience: ["Technical Teams","Executives"], fields: ["Data"], size: "< 8", desc: "Practical data storytelling, SQL, and dashboards that drive decisions." },
    { id: "CYBER", name: "Cybersecurity Foundations", duration: "< 3 weeks", audience: ["Technical Teams","Mixed Levels"], fields: ["Cybersecurity"], size: "< 8", desc: "Essential threat awareness, security protocols, and hands-on defence techniques." },
    { id: "CORP-AI", name: "Corporate AI Transformation", duration: "< 3 days", audience: ["Executives","Mixed Levels"], fields: ["AI"], size: "> 25", desc: "Large-scale AI upskilling across departments \u2014 strategy to execution." },
    { id: "CORP-DS", name: "Data Science for Enterprise", duration: "< 3 weeks", audience: ["Technical Teams"], fields: ["Data"], size: "> 25", desc: "Scalable data science training \u2014 from analytics to ML pipelines." },
];
const SIZE_MAP = { "< 8 people": "< 8", "12 \u2013 15 people": "12 \u2013 15", "> 25 people": "> 25" };

// ── Field metadata ──────────────────────────────────────────────
const FIELD_META = {
    AI:            { icon: "\u2726", sub: "Tools, agents & automation" },
    Cybersecurity: { icon: "\uD83D\uDEE1", sub: "Threat defence & protocols" },
    Data:          { icon: "\u25C8", sub: "Analytics & data science" },
    "Full-Stack":  { icon: "\u2B21", sub: "Web development" },
};

// ═══════════════════════════════════════════════════════════════════
// STATE
// ═══════════════════════════════════════════════════════════════════
let state = {
    step: 0, direction: "forward",
    employees: null, iterations: null,
    field: [], duration: null,
    audience: [], location: null, company: "",
};
let isThinking = false;
let isLoading = false;
let showResults = false;
let results = null;
let errorMsg = "";

// ── Spark SVG ───────────────────────────────────────────────────
function sparkSVG(size, color) {
    return `<svg width="${size}" height="${size}" viewBox="0 0 16 16" fill="${color}"><path d="M8 0L9.2 6.8L16 8L9.2 9.2L8 16L6.8 9.2L0 8L6.8 6.8L8 0Z"/></svg>`;
}

// ── Local scoring fallback ──────────────────────────────────────
function localRecommend() {
    const scored = COURSES.map(c => {
        let score = 0;
        if (state.audience.some(a => c.audience.includes(a))) score += 3;
        if (state.field.some(f => c.fields.includes(f))) score += 3;
        if (c.duration === state.duration) score += 2;
        if (state.employees && c.size === SIZE_MAP[state.employees]) score += 1;
        return { ...c, score };
    });
    scored.sort((a, b) => b.score - a.score);
    const top = scored.slice(0, 2);
    const name = state.company.trim().split(" ")[0] || null;
    return {
        greeting: name ? `Here's what we'd recommend for ${name}` : "Your top program picks",
        recommendations: top.map(c => ({
            courseTitle: c.name, courseType: c.fields[0] || "",
            duration: c.duration, tag: c.audience[0] || "",
            whyThisFits: c.desc, description: c.desc,
        })),
        note: "Our advisors will tailor the details to your team.",
    };
}

// ── Navigation helpers ──────────────────────────────────────────
function advanceWithThink() {
    if (state.step < QUESTIONS.length - 1) {
        isThinking = true; render();
        setTimeout(() => {
            isThinking = false;
            state.step++; state.direction = "forward";
            render();
        }, 450);
    } else {
        // Submit
        showResults = true; isLoading = true; errorMsg = "";
        render(); fetchRecommendations();
    }
}

function goBack() {
    if (showResults) { showResults = false; isLoading = false; results = null; errorMsg = ""; render(); return; }
    if (isThinking) return;
    if (state.step > 0) { state.step--; state.direction = "back"; render(); }
}

function restart() {
    state = { step: 0, direction: "forward", employees: null, iterations: null, field: [], duration: null, audience: [], location: null, company: "" };
    isThinking = false; isLoading = false; showResults = false; results = null; errorMsg = "";
    render();
}

function toggleMulti(key, val) {
    const idx = state[key].indexOf(val);
    if (idx >= 0) state[key].splice(idx, 1);
    else state[key].push(val);
    render();
}

// ── Fetch recommendations ───────────────────────────────────────
async function fetchRecommendations() {
    if (!WORKER_URL) {
        setTimeout(() => { results = localRecommend(); isLoading = false; render(); }, 2000);
        return;
    }
    try {
        const endpoint = WORKER_URL.replace(/\/$/, "") + "/workshop-recommend";
        const res = await fetch(endpoint, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                duration: state.duration || "",
                teamSize: state.employees || "",
                multipleIterations: state.iterations === "Multiple iterations",
                location: state.location || "",
                audience: state.audience,
                companyName: state.company,
                freeText: state.field.join(", "),
                promptContext: AI_PROMPT,
            }),
        });
        if (!res.ok) { const d = await res.json().catch(() => null); throw new Error(d?.error || `Request failed (${res.status})`); }
        results = await res.json();
    } catch (err) {
        errorMsg = err.message || "Something went wrong";
    }
    isLoading = false; render();
}

// ═══════════════════════════════════════════════════════════════════
// RENDER
// ═══════════════════════════════════════════════════════════════════
function render() {
    const el = document.getElementById("wizard-content");
    const prog = document.getElementById("progress-section");
    if (!el || !prog) return;

    // Progress bar
    const pct = (state.step / QUESTIONS.length) * 100;
    if (!showResults && !isThinking) {
        prog.style.display = "flex";
        prog.innerHTML = `
            <div class="progress-bar"><div class="progress-fill" style="width:${pct}%"></div></div>
            <span style="font-size:12px;color:#A0AEBD;font-weight:500;white-space:nowrap">${state.step + 1} of ${QUESTIONS.length}</span>
        `;
    } else {
        prog.style.display = "none";
    }

    // Thinking state
    if (isThinking) {
        el.innerHTML = `<div class="thinking-dots"><div class="thinking-dot"></div><div class="thinking-dot"></div><div class="thinking-dot"></div></div>`;
        return;
    }

    // Results
    if (showResults) {
        if (isLoading) {
            el.innerHTML = `
                <div class="step-content">
                    <div style="display:flex;align-items:center;gap:10px;margin-bottom:14px">
                        ${sparkSVG(16, ACCENT)}
                        <span style="color:${ACCENT};font-size:14px;font-weight:500">Analyzing our catalog for you...</span>
                    </div>
                    <div class="thinking-dots"><div class="thinking-dot"></div><div class="thinking-dot"></div><div class="thinking-dot"></div></div>
                </div>`;
            return;
        }
        if (errorMsg) {
            el.innerHTML = `
                <div class="step-content">
                    <p style="color:#DC2626;font-size:14px;margin-bottom:12px">${errorMsg}</p>
                    <div class="nav-row">
                        <button class="btn-back" onclick="goBack()">${backSVG()}</button>
                        <button class="btn-primary" onclick="errorMsg='';isLoading=true;render();fetchRecommendations()">Try again</button>
                    </div>
                </div>`;
            return;
        }
        if (results) {
            const recs = results.recommendations || [];
            const gridClass = recs.length > 1 ? "results-grid two-col" : "results-grid";
            el.innerHTML = `
                <div class="step-content">
                    <div style="display:flex;align-items:center;gap:7px;margin-bottom:6px">
                        ${sparkSVG(13, ACCENT)}
                        <span style="font-size:11px;font-weight:600;color:${ACCENT};letter-spacing:0.12em;text-transform:uppercase">Your recommendations</span>
                    </div>
                    <p style="font-family:'Syne',sans-serif;font-weight:700;font-size:20px;color:#0A1628;margin:0 0 4px">${results.greeting || "Your top program picks"}</p>
                    ${results.note ? `<p style="font-size:13px;color:#9AAABB;margin:0 0 20px">${results.note}</p>` : ""}
                    <div class="${gridClass}">
                        ${recs.map((r, i) => renderResultCard(r, i === 0, i)).join("")}
                    </div>
                    <div style="display:flex;align-items:center;gap:10px;margin-top:20px;flex-wrap:wrap">
                        <a href="mailto:pro@coded.com" class="btn-primary" style="text-decoration:none;display:inline-block">Book a Consultation</a>
                        <button class="btn-outline" onclick="restart()">Start over</button>
                    </div>
                </div>`;
            // Animate cards in
            setTimeout(() => { document.querySelectorAll('.result-card').forEach((c, i) => { setTimeout(() => c.classList.add('visible'), i * 100); }); }, 50);
            return;
        }
    }

    // Steps
    const q = QUESTIONS[state.step];
    const dir = state.direction === "back" ? "back" : "";

    if (q.id === "employees") {
        const chips = ["< 8 people", "12 \u2013 15 people", "> 25 people"].map(o =>
            `<button class="chip${state.employees === o ? ' selected' : ''}" onclick="state.employees='${o}';state.iterations=null;render();${o !== '> 25 people' ? "setTimeout(advanceWithThink,130)" : ""}">${o}</button>`
        ).join("");
        let sub = "";
        if (state.employees === "> 25 people") {
            sub = `<div style="margin-top:16px;padding-top:16px;border-top:1px solid #EEF1F6;animation:fadeUp 0.28s ease">
                <p style="font-size:13px;color:#7A8899;margin-bottom:10px;font-weight:500">Will this run across multiple cohorts?</p>
                <div class="chips-row">
                    ${["Single cohort","Multiple iterations"].map(o =>
                        `<button class="chip${state.iterations === o ? ' selected' : ''}" onclick="state.iterations='${o}';render();setTimeout(advanceWithThink,130)">${o}</button>`
                    ).join("")}
                </div>
            </div>`;
        }
        el.innerHTML = `<div class="step-content ${dir}">
            <p class="q-title">${q.text}</p><p class="q-hint">${q.hint}</p>
            <div class="chips-row">${chips}</div>
            ${sub}
            ${state.step > 0 ? `<div class="nav-row"><button class="btn-back" onclick="goBack()">${backSVG()}</button></div>` : ""}
        </div>`;
    }
    else if (q.id === "field") {
        const cards = Object.entries(FIELD_META).map(([id, meta]) =>
            `<button class="field-card${state.field.includes(id) ? ' selected' : ''}" onclick="toggleMulti('field','${id}')">
                <div class="icon-box">${meta.icon}</div>
                <div><div class="label">${id}</div><div class="sub">${meta.sub}</div></div>
            </button>`
        ).join("");
        el.innerHTML = `<div class="step-content ${dir}">
            <p class="q-title">${q.text}</p><p class="q-hint">${q.hint}</p>
            <div class="field-grid">${cards}</div>
            <div class="nav-row">
                <button class="btn-back" onclick="goBack()">${backSVG()}</button>
                <button class="btn-primary" onclick="advanceWithThink()" ${state.field.length === 0 ? 'disabled' : ''}>Continue \u2192</button>
            </div>
        </div>`;
    }
    else if (q.id === "duration") {
        const chips = ["1 day","< 3 days","< 3 weeks","> 5 weeks"].map(o =>
            `<button class="chip${state.duration === o ? ' selected' : ''}" onclick="state.duration='${o}';render();setTimeout(advanceWithThink,130)">${o}</button>`
        ).join("");
        el.innerHTML = `<div class="step-content ${dir}">
            <p class="q-title">${q.text}</p><p class="q-hint">${q.hint}</p>
            <div class="chips-row">${chips}</div>
            <div class="nav-row"><button class="btn-back" onclick="goBack()">${backSVG()}</button></div>
        </div>`;
    }
    else if (q.id === "audience") {
        const chips = ["Fresh Graduates","Technical Teams","Executives","Mixed Levels"].map(o =>
            `<button class="chip${state.audience.includes(o) ? ' selected' : ''}" onclick="toggleMulti('audience','${o}')">${o}</button>`
        ).join("");
        el.innerHTML = `<div class="step-content ${dir}">
            <p class="q-title">${q.text}</p><p class="q-hint">${q.hint}</p>
            <div class="chips-row">${chips}</div>
            <div class="nav-row">
                <button class="btn-back" onclick="goBack()">${backSVG()}</button>
                <button class="btn-primary" onclick="advanceWithThink()" ${state.audience.length === 0 ? 'disabled' : ''}>Continue \u2192</button>
            </div>
        </div>`;
    }
    else if (q.id === "location") {
        const chips = ["At CODED HQ","At our office","Flexible / Online"].map(o =>
            `<button class="chip${state.location === o ? ' selected' : ''}" onclick="state.location='${o}';render();setTimeout(advanceWithThink,130)">${o}</button>`
        ).join("");
        el.innerHTML = `<div class="step-content ${dir}">
            <p class="q-title">${q.text}</p><p class="q-hint">${q.hint}</p>
            <div class="chips-row">${chips}</div>
            <div class="nav-row"><button class="btn-back" onclick="goBack()">${backSVG()}</button></div>
        </div>`;
    }
    else if (q.id === "company") {
        el.innerHTML = `<div class="step-content ${dir}">
            <p class="q-title">${q.text}</p><p class="q-hint">${q.hint}</p>
            <input id="company-input" class="text-input" placeholder="Type here\u2026" value="${state.company}" />
            <div class="nav-row">
                <button class="btn-back" onclick="goBack()">${backSVG()}</button>
                <button class="btn-primary" onclick="advanceWithThink()">See recommendations \u2192</button>
                <button class="btn-ghost" onclick="advanceWithThink()">Skip</button>
            </div>
        </div>`;
        const inp = document.getElementById("company-input");
        if (inp) {
            inp.focus();
            inp.addEventListener("input", e => { state.company = e.target.value; });
            inp.addEventListener("keydown", e => { if (e.key === "Enter") advanceWithThink(); });
        }
    }
}

function renderResultCard(rec, isBest, idx) {
    const tags = [rec.courseType, rec.duration, rec.tag].filter(Boolean).map(t =>
        `<span class="tag">${t}</span>`
    ).join("");
    return `<div class="result-card${isBest ? ' best' : ''}">
        ${isBest ? '<div class="top-line"></div>' : ''}
        ${isBest ? `<div class="badge">${sparkSVG(9, ACCENT)} Best Match</div>` : ''}
        <div class="card-title">${rec.courseTitle}</div>
        <div class="card-desc">${rec.whyThisFits || rec.description}</div>
        <div class="tags">${tags}</div>
    </div>`;
}

function backSVG() {
    return `<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13L5 8L10 3"/></svg>`;
}

// ═══════════════════════════════════════════════════════════════════
// INIT
// ═══════════════════════════════════════════════════════════════════
document.addEventListener("DOMContentLoaded", render);
</script>

<!-- ═══════════════════════════════════════════════════════════════ -->
<!-- MESH BACKGROUND + PROGRAM FINDER                              -->
<!-- ═══════════════════════════════════════════════════════════════ -->
<div class="mesh-bg">
    <!-- Animated blobs -->
    <div class="mesh-blob mesh-blob-1"></div>
    <div class="mesh-blob mesh-blob-2"></div>
    <div class="mesh-blob mesh-blob-3"></div>
    <div class="mesh-blob mesh-blob-4"></div>

    <!-- Finder card -->
    <div class="finder-card">
        <!-- Spark decorations -->
        <div class="spark-field">
            <svg class="spark-svg" style="top:9%;left:94%;width:14px;height:14px;opacity:0.22;animation:sparkFloat 3.4s ease-in-out 0s infinite" viewBox="0 0 16 16" fill="#2563EB"><path d="M8 0L9.2 6.8L16 8L9.2 9.2L8 16L6.8 9.2L0 8L6.8 6.8L8 0Z"/></svg>
            <svg class="spark-svg" style="top:78%;left:97%;width:9px;height:9px;opacity:0.18;animation:sparkFloat 2.8s ease-in-out 1.2s infinite" viewBox="0 0 16 16" fill="#2563EB"><path d="M8 0L9.2 6.8L16 8L9.2 9.2L8 16L6.8 9.2L0 8L6.8 6.8L8 0Z"/></svg>
            <svg class="spark-svg" style="top:60%;left:1%;width:18px;height:18px;opacity:0.15;animation:sparkFloat 3.8s ease-in-out 0.7s infinite" viewBox="0 0 16 16" fill="#2563EB"><path d="M8 0L9.2 6.8L16 8L9.2 9.2L8 16L6.8 9.2L0 8L6.8 6.8L8 0Z"/></svg>
            <svg class="spark-svg" style="top:20%;left:2%;width:7px;height:7px;opacity:0.2;animation:sparkFloat 3.1s ease-in-out 2s infinite" viewBox="0 0 16 16" fill="#2563EB"><path d="M8 0L9.2 6.8L16 8L9.2 9.2L8 16L6.8 9.2L0 8L6.8 6.8L8 0Z"/></svg>
        </div>

        <!-- Header -->
        <div style="margin-bottom:32px;position:relative;z-index:1">
            <div style="display:flex;align-items:center;gap:6px;margin-bottom:8px">
                <svg width="12" height="12" viewBox="0 0 16 16" fill="#2563EB"><path d="M8 0L9.2 6.8L16 8L9.2 9.2L8 16L6.8 9.2L0 8L6.8 6.8L8 0Z"/></svg>
                <span style="font-size:11px;font-weight:600;color:#2563EB;letter-spacing:0.13em;text-transform:uppercase">CODED &middot; Program Finder</span>
            </div>
            <h2 style="font-family:'Syne',sans-serif;font-weight:700;font-size:26px;color:#0A1628;line-height:1.2;margin:0">
                Find the right program<br>for your team
            </h2>
            <p style="font-size:14px;color:#7A8899;margin-top:6px;font-weight:400">Answer a few questions &mdash; we'll match you in seconds.</p>
        </div>

        <!-- Progress -->
        <div id="progress-section" style="display:flex;align-items:center;gap:12px;margin-bottom:32px;position:relative;z-index:1"></div>

        <!-- Step content -->
        <div id="wizard-content" style="min-height:220px;position:relative;z-index:1"></div>
    </div>
</div>

<!-- ═══════════════════════════════════════════════════════════════ -->
<!-- STANDALONE COURSE CARDS (CODEDCourseCard preview)             -->
<!-- ═══════════════════════════════════════════════════════════════ -->
<div class="standalone-section">
    <div style="display:flex;align-items:center;gap:7px;margin-bottom:6px">
        <svg width="13" height="13" viewBox="0 0 16 16" fill="#2563EB"><path d="M8 0L9.2 6.8L16 8L9.2 9.2L8 16L6.8 9.2L0 8L6.8 6.8L8 0Z"/></svg>
        <span style="font-size:11px;font-weight:600;color:#2563EB;letter-spacing:0.12em;text-transform:uppercase">Standalone Course Cards</span>
    </div>
    <p class="section-label">CODEDCourseCard — Preview</p>
    <p class="section-hint">These cards can be placed anywhere on your Framer site as independent components.</p>

    <div class="standalone-grid">
        <!-- Featured card -->
        <div class="standalone-card featured">
            <div class="top-line"></div>
            <div class="badge">
                <svg width="9" height="9" viewBox="0 0 16 16" fill="#2563EB"><path d="M8 0L9.2 6.8L16 8L9.2 9.2L8 16L6.8 9.2L0 8L6.8 6.8L8 0Z"/></svg>
                Best Match
            </div>
            <div class="card-title">AI Champions Program</div>
            <div class="card-desc">Strategic AI literacy for leadership &mdash; think differently about automation & tools.</div>
            <div class="tags">
                <span class="tag">Workshop</span>
                <span class="tag">4-6 Hours</span>
                <span class="tag">AI</span>
            </div>
            <a href="mailto:pro@coded.com" class="cta-btn">Learn More</a>
        </div>

        <!-- Standard card -->
        <div class="standalone-card">
            <div class="card-title">Full-Stack Bootcamp</div>
            <div class="card-desc">End-to-end web development mastery &mdash; from design to deployment.</div>
            <div class="tags">
                <span class="tag">Bootcamp</span>
                <span class="tag">&gt; 5 weeks</span>
                <span class="tag">Full-Stack</span>
            </div>
            <a href="mailto:pro@coded.com" class="cta-btn">Learn More</a>
        </div>

        <!-- Featured card 2 -->
        <div class="standalone-card featured">
            <div class="top-line"></div>
            <div class="badge">
                <svg width="9" height="9" viewBox="0 0 16 16" fill="#2563EB"><path d="M8 0L9.2 6.8L16 8L9.2 9.2L8 16L6.8 9.2L0 8L6.8 6.8L8 0Z"/></svg>
                Popular
            </div>
            <div class="card-title">Data Analytics Sprint</div>
            <div class="card-desc">Practical data storytelling, SQL, and dashboards that drive decisions.</div>
            <div class="tags">
                <span class="tag">Sprint</span>
                <span class="tag">&lt; 3 weeks</span>
                <span class="tag">Data</span>
            </div>
            <a href="mailto:pro@coded.com" class="cta-btn">Learn More</a>
        </div>

        <!-- Standard card 2 -->
        <div class="standalone-card">
            <div class="card-title">Cybersecurity Foundations</div>
            <div class="card-desc">Essential threat awareness, security protocols, and hands-on defence techniques.</div>
            <div class="tags">
                <span class="tag">Workshop</span>
                <span class="tag">&lt; 3 weeks</span>
                <span class="tag">Cybersecurity</span>
            </div>
            <a href="mailto:pro@coded.com" class="cta-btn">Learn More</a>
        </div>
    </div>
</div>

<div class="preview-footer">
    CODED Program Finder &mdash; Component Preview &middot; Drop .tsx files into Framer &gt; Assets &gt; Code
</div>

</body>
</html>
